<div class="card p-8">
    <div class="mb-6">
        <h2 class="text-2xl font-bold mb-2">Nuevo Paciente</h2>
        <p class="text-gray-600">Complete los datos para crear un nuevo paciente</p>
    </div>

    <form [formGroup]="form" (ngSubmit)="submit()" class="max-w-2xl">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <!-- Nombre -->
            <div class="field">
                <label for="name" class="block text-sm font-medium mb-2">
                    Nombre *
                </label>
                <input
                    id="name"
                    type="text"
                    pInputText
                    formControlName="name"
                    placeholder="Ingrese el nombre"
                    class="w-full"
                    [class]="{'ng-invalid ng-dirty': form.get('name')?.invalid && form.get('name')?.touched}"
                />
                <small class="text-red-500 text-sm mt-1 block" *ngIf="getFieldError('name')">
                    {{ getFieldError('name') }}
                </small>
            </div>

            <!-- Apellido -->
            <div class="field">
                <label for="last_name" class="block text-sm font-medium mb-2">
                    Apellido *
                </label>
                <input
                    id="last_name"
                    type="text"
                    pInputText
                    formControlName="last_name"
                    placeholder="Ingrese el apellido"
                    class="w-full"
                    [class]="{'ng-invalid ng-dirty': form.get('last_name')?.invalid && form.get('last_name')?.touched}"
                />
                <small class="text-red-500 text-sm mt-1 block" *ngIf="getFieldError('last_name')">
                    {{ getFieldError('last_name') }}
                </small>
            </div>

            <!-- Fecha de Nacimiento -->
            <div class="field">
                <label for="birth_date" class="block text-sm font-medium mb-2">
                    Fecha de Nacimiento *
                </label>
                <input
                    id="birth_date"
                    type="date"
                    formControlName="birth_date"
                    class="w-full p-inputtext"
                    [class]="{'ng-invalid ng-dirty': form.get('birth_date')?.invalid && form.get('birth_date')?.touched}"
                />
                <small class="text-red-500 text-sm mt-1 block" *ngIf="getFieldError('birth_date')">
                    {{ getFieldError('birth_date') }}
                </small>
            </div>

            <!-- Género -->
            <div class="field">
                <label for="gender" class="block text-sm font-medium mb-2">
                    Género *
                </label>
                <p-select
                    id="gender"
                    formControlName="gender"
                    [options]="genderOptions"
                    placeholder="Seleccione género"
                    class="w-full"
                    [class]="{'ng-invalid ng-dirty': form.get('gender')?.invalid && form.get('gender')?.touched}"
                ></p-select>
                <small class="text-red-500 text-sm mt-1 block" *ngIf="getFieldError('gender')">
                    {{ getFieldError('gender') }}
                </small>
            </div>

            <!-- Tipo de Documento -->
            <div class="field">
                <label for="type_document" class="block text-sm font-medium mb-2">
                    Tipo de Documento *
                </label>
                <p-select
                    id="type_document"
                    formControlName="type_document"
                    [options]="documentTypeOptions"
                    placeholder="Seleccione tipo de documento"
                    class="w-full"
                    [class]="{'ng-invalid ng-dirty': form.get('type_document')?.invalid && form.get('type_document')?.touched}"
                ></p-select>
                <small class="text-red-500 text-sm mt-1 block" *ngIf="getFieldError('type_document')">
                    {{ getFieldError('type_document') }}
                </small>
            </div>

            <!-- Número de Documento -->
            <div class="field">
                <label for="documentnumber" class="block text-sm font-medium mb-2">
                    Número de Documento *
                </label>
                <input
                    id="documentnumber"
                    type="text"
                    pInputText
                    formControlName="documentnumber"
                    placeholder="10 dígitos"
                    class="w-full"
                    [class]="{'ng-invalid ng-dirty': form.get('documentnumber')?.invalid && form.get('documentnumber')?.touched}"
                    (input)="cleanDocumentInput($event)"
                    (keypress)="onDocumentKeyPress($event)"
                    (paste)="onDocumentPaste($event)"
                    pattern="[0-9]{10}"
                    maxlength="10"
                />
                <small class="text-red-500 text-sm mt-1 block" *ngIf="getFieldError('documentnumber')">
                    {{ getFieldError('documentnumber') }}
                </small>
                <small class="text-gray-500 text-sm mt-1 block">
                    Caracteres: {{ form.get('documentnumber')?.value?.length || 0 }}/10
                </small>
            </div>

            <!-- Teléfono -->
            <div class="field">
                <label for="telephone" class="block text-sm font-medium mb-2">
                    Teléfono *
                </label>
                <input
                    id="telephone"
                    type="text"
                    pInputText
                    formControlName="telephone"
                    placeholder="10 dígitos"
                    class="w-full"
                    [class]="{'ng-invalid ng-dirty': form.get('telephone')?.invalid && form.get('telephone')?.touched}"
                    (input)="cleanTelephoneInput($event)"
                    (keypress)="onTelephoneKeyPress($event)"
                    (paste)="onTelephonePaste($event)"
                    pattern="[0-9]{10}"
                    maxlength="10"
                />
                <small class="text-red-500 text-sm mt-1 block" *ngIf="getFieldError('telephone')">
                    {{ getFieldError('telephone') }}
                </small>
                <small class="text-gray-500 text-sm mt-1 block">
                    Caracteres: {{ form.get('telephone')?.value?.length || 0 }}/10
                </small>
            </div>

            <!-- Dirección -->
            <div class="field md:col-span-2">
                <label for="address" class="block text-sm font-medium mb-2">
                    Dirección *
                </label>
                <input
                    id="address"
                    type="text"
                    pInputText
                    formControlName="address"
                    placeholder="Ingrese la dirección completa"
                    class="w-full"
                    [class]="{'ng-invalid ng-dirty': form.get('address')?.invalid && form.get('address')?.touched}"
                />
                <small class="text-red-500 text-sm mt-1 block" *ngIf="getFieldError('address')">
                    {{ getFieldError('address') }}
                </small>
            </div>

            <!-- Estado -->
            <div class="field">
                <label for="status" class="block text-sm font-medium mb-2">
                    Estado *
                </label>
                <p-select
                    id="status"
                    formControlName="status"
                    [options]="statusOptions"
                    placeholder="Seleccione estado"
                    class="w-full"
                ></p-select>
            </div>
        </div>

        <div class="flex gap-3 mt-6">
            <button
                pButton
                type="submit"
                label="Crear Paciente"
                icon="pi pi-check"
                class="p-button-success"
                [loading]="loading"
                [disabled]="loading"
            ></button>
            
            <button
                pButton
                type="button"
                label="Cancelar"
                icon="pi pi-times"
                class="p-button-secondary"
                (click)="cancelar()"
                [disabled]="loading"
            ></button>
        </div>
    </form>
</div>

<p-toast></p-toast>